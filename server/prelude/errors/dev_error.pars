// Environment variables available in this template:
//
// error (Dictionary)
//   .code (Integer)          - HTTP status code (e.g., 500)
//   .message (String)        - HTTP status text (e.g., "Internal Server Error")
//   .message_text (String)   - Detailed error message
//   .details (String)        - Full error details (dev mode only)
//   .file (String)           - Source file path where error occurred (if available)
//   .line (Integer)          - Line number where error occurred (if available)
//   .column (Integer)        - Column number where error occurred (if available)
//   .source (Array)          - Source code context around the error (if available)
//     Each element is a Dictionary with:
//       .number (Integer)    - Line number
//       .content (String)    - Line content
//       .is_error (Boolean)  - true if this is the error line
//   .request (Dictionary)    - Request information (dev mode only)
//     .method (String)       - HTTP method (e.g., "GET")
//     .path (String)         - Request path
//     .query (String)        - Query string
//
// basil (Dictionary)
//   .version (String)        - Basil version
//   .dev (Boolean)           - true if in development mode

<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
	<title>"Error " + error.code</title>
	<style>
		* { box-sizing: border-box; margin: 0; padding: 0; }
		body {
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
			background: #1a1a2e;
			color: #eee;
			padding: 2rem;
			min-height: 100vh;
		}
		.container {
			max-width: 1000px;
			margin: 0 auto;
		}
		h1 {
			font-size: 1.5rem;
			margin-bottom: 1.5rem;
			color: #ff6b6b;
		}
		.error-code {
			display: inline-block;
			background: #ff6b6b;
			color: #1a1a2e;
			padding: 0.2rem 0.5rem;
			border-radius: 4px;
			font-size: 0.75rem;
			font-weight: 600;
			margin-right: 0.5rem;
		}
		.section {
			background: #16213e;
			border-radius: 8px;
			padding: 1rem 1.25rem;
			margin-bottom: 1rem;
			border-left: 4px solid #ff6b6b;
		}
		.section h2 {
			font-size: 0.875rem;
			text-transform: uppercase;
			color: #7f8c8d;
			margin-bottom: 0.75rem;
		}
		.message {
			color: #eee;
			font-size: 1rem;
			line-height: 1.5;
			margin-bottom: 0.5rem;
		}
		.location {
			color: #7f8c8d;
			font-family: 'SF Mono', Monaco, 'Courier New', monospace;
			font-size: 0.875rem;
			margin-top: 0.5rem;
		}
		.code-block {
			background: #0f1419;
			padding: 1rem;
			border-radius: 4px;
			font-family: 'SF Mono', Monaco, 'Courier New', monospace;
			font-size: 0.875rem;
			overflow-x: auto;
			line-height: 1.6;
		}
		.line-number {
			color: #7f8c8d;
			margin-right: 0.5rem;
		}
		.line-error {
			color: #ff6b6b;
			font-weight: 600;
			background: rgba(255, 107, 107, 0.1);
			display: inline-block;
			width: 100%;
		}
		.details {
			background: #0f1419;
			padding: 1rem;
			border-radius: 4px;
			font-family: 'SF Mono', Monaco, 'Courier New', monospace;
			font-size: 0.875rem;
			color: #f39c12;
			overflow-x: auto;
			white-space: pre-wrap;
			word-break: break-word;
		}
		.request-info {
			display: grid;
			gap: 0.5rem;
		}
		.request-row {
			display: flex;
			gap: 1rem;
		}
		.request-label {
			color: #7f8c8d;
			min-width: 80px;
			font-weight: 600;
		}
		.request-value {
			color: #f39c12;
			font-family: 'SF Mono', Monaco, 'Courier New', monospace;
			font-size: 0.875rem;
		}
		.stack {
			background: #0f1419;
			padding: 1rem;
			border-radius: 4px;
			font-family: 'SF Mono', Monaco, 'Courier New', monospace;
			font-size: 0.875rem;
			overflow-x: auto;
			white-space: pre;
		}
		.stack-line {
			line-height: 1.5;
			color: #95a5a6;
		}
	</style>
</head>
<body>
	<div class="container">
		<h1>
			<span class="error-code">error.code</span>
			error.message.htmlEncode() 
		</h1>
		if (error.message_text) {
			<div class="section">
				<h2>"Error Details"</h2>
				<div class="message">error.message_text.htmlEncode() </div>
				if (error.file) {
					<div class="location">
						"at " + error.file + ":" + error.line + ":" + error.column
					</div>
				}
			</div>
		}
		
		if (error.source) {
			<div class="section">
				<h2>"Source Code"</h2>
				<pre class="code-block">
					for (line in error.source) {
						if (line.is_error) {
							<span class="line-error">line.number + " | " + line.content.htmlEncode() + " <-- ERROR"</span><br/>
						} else {
							<span class="line-number">line.number</span>"| " + line.content.htmlEncode()<br/>
						}
					}
				</pre>	
			</div>
		}
		
		if (error.request) {
			<div class="section">
				<h2>"Request Information"</h2>
				<div class="request-info">
					<div class="request-row">
						<div class="request-label">"Method:"</div>
						<div class="request-value">error.request.method</div>
					</div>
					<div class="request-row">
						<div class="request-label">"Path:"</div>
						<div class="request-value">error.request.path</div>
					</div>
					if (error.request.query) {
						<div class="request-row">
							<div class="request-label">"Query:"</div>
							<div class="request-value">error.request.query</div>
						</div>
					}
				</div>
			</div>
		}
		
		<div class="section">
			<h2>"Server Information"</h2>
			<div class="request-info">
				<div class="request-row">
					<div class="request-label">"Version:"</div>
					<div class="request-value">basil.version</div>
				</div>
				<div class="request-row">
					<div class="request-label">"Mode:"</div>
					<div class="request-value">"development"</div>
				</div>
			</div>
		</div>
	</div>
</body>
</html>

