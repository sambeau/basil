---
id: BUG-004
title: "Live reload endpoint creates log noise"
status: resolved
priority: low
created: 2025-11-30
reporter: "@sambeau"
---

# BUG-004: Live reload endpoint creates log noise

## Summary
The live reload feature in dev mode generates a log entry every second for the `/__livereload` endpoint polling, which creates excessive log noise.

## Observed Behavior
Logs show `GET /__livereload 200` entries every second, even when no files have changed:

```
2025-11-30T22:29:47Z GET /__livereload 200 15.416µs
2025-11-30T22:29:48Z GET /__livereload 200 22µs
2025-11-30T22:29:49Z GET /__livereload 200 28.916µs
... (continues every second)
```

## Expected Behavior
The polling mechanism itself is correct (the browser needs to check for changes). However, the polling requests should be excluded from request logging to reduce noise in development.

## Reproduction Steps
1. Run `basil --dev` with any configuration
2. Open a page in the browser
3. Observe server logs showing `/__livereload` requests every second

## Environment
- OS: macOS
- Go: 1.21+
- Basil: current dev branch

## Impact
- **Severity**: Low
- **User Impact**: Log noise makes it harder to see meaningful requests during development

## Investigation Notes

The live reload architecture is:
1. JavaScript injected into HTML polls `/__livereload` every 1 second
2. Server returns `{seq: N}` where N increments on file changes
3. Client reloads if seq changed since last poll

This polling is expected behavior. The issue is that these internal polling requests are logged alongside user requests, creating noise.

## Resolution Notes

### Changes Made
1. **Skip logging for `/__livereload`**: The request logger now checks for this path and skips logging
2. **Config change message**: Updated to clarify that browser will reload but server restart needed for config changes to take effect
3. **SIGHUP triggers browser reload**: Added `TriggerReload()` method to watcher, called by `ReloadScripts()` so SIGHUP also triggers browser reload in dev mode

### Files Changed
- `server/logging.go` - Skip logging for `/__livereload`
- `server/watcher.go` - Add `TriggerReload()` method, update config change message
- `server/server.go` - Call `TriggerReload()` in `ReloadScripts()`
- `server/logging_test.go` - Add test for skipped logging

