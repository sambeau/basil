---
id: BUG-001
title: "Aggressive script caching prevents live editing in dev mode"
status: resolved
severity: medium
created: 2025-11-30
reporter: "@human"
---

# BUG-001: Aggressive script caching prevents live editing in dev mode

## Summary
Parsley scripts are cached and require a server restart to see changes, even in dev mode where no caching should occur.

## Observed Behavior
- Edit a Parsley script while the server is running
- Refresh the browser
- The old version of the script is served
- Server restart is required to see changes

## Expected Behavior
- **Dev mode (`--dev`)**: No caching at all - scripts and static files should be reloaded on every request
- **Production mode**: Static files cached with TTL; Parsley scripts NOT cached by default (they're dynamic)

## Reproduction Steps
1. Run `basil --dev --config basil.yaml` in `examples/hello`
2. Visit `http://localhost:8080/`
3. Edit `handlers/index.pars` (e.g., change the greeting text)
4. Refresh the browser
5. Old content is still shown
6. Must restart server to see changes

## Environment
- OS: macOS
- Go version: 1.21+
- Basil version: Phase 1 MVP (feat/FEAT-002-basil-server branch)

---
<!-- BELOW THIS LINE: AI-FOCUSED INVESTIGATION DETAILS -->

## Investigation Notes

### Root Cause
The `scriptCache` in `server/handler.go` cached scripts indefinitely with no awareness of dev mode.

### Affected Code
- `server/handler.go` — scriptCache implementation
- `server/server.go` — cache initialization

## Resolution

### Fix Description
Added `devMode` field to `scriptCache`. In dev mode, the cache is bypassed entirely and scripts are always read from disk on each request.

### Test Coverage
Existing tests pass; manual testing confirmed live editing works.

## Related
- Fix commit: `2f587bf`
- Related features: FEAT-002 (Basil Web Server)
