---
id: FEAT-065
title: "Project Init Command"
status: draft
priority: medium
created: 2025-12-11
author: "@human + AI"
---

# FEAT-065: Project Init Command

## Summary
Add a `basil --init <foldername>` command that scaffolds a minimal Basil project with sensible defaults. This creates the basic directory structure, a starter handler, and a working configuration file, allowing developers to get up and running in seconds.

## User Story
As a developer new to Basil, I want a simple command to create a new project so that I can start building without manually creating folders and config files.

## Acceptance Criteria

### Core Functionality
- [ ] `basil --init <foldername>` creates the specified folder if it doesn't exist
- [ ] Error if folder exists and is not empty (prevent accidental overwrite)
- [ ] Creates `site/` subdirectory
- [ ] Creates `public/` subdirectory
- [ ] Creates `site/index.pars` with minimal "Hello from Basil" content
- [ ] Creates `basil.yaml` with working defaults
- [ ] Prints success message with next steps

### YAML Configuration
- [ ] Uses `site:` mode (filesystem routing)
- [ ] Sets `public_dir: ./public`
- [ ] Includes server host/port defaults
- [ ] Includes helpful comments explaining options
- [ ] Uses relative paths (works from any directory)

### Error Handling
- [ ] Validates folder name (no invalid characters)
- [ ] Checks if path is a file (error if so)
- [ ] Checks if folder exists and has files (error if not empty)
- [ ] Creates intermediate directories if needed
- [ ] Clear error messages for all failure cases

### User Experience
- [ ] Success message shows created structure
- [ ] Instructions on how to start server (`cd <folder> && basil`)
- [ ] Help text documents the command (`basil --help`)

## Design Decisions

- **Site mode over routes mode**: Simpler for beginners, no routes config needed
- **Minimal index.pars**: Just `<h1>ðŸŒ¿ Hello from Basil ðŸ‘‹</h1>` - easy to understand and modify
- **Error on non-empty folder**: Safety first - don't accidentally overwrite existing projects
- **Create folder if missing**: Convenience - most common use case
- **Relative paths in YAML**: Works regardless of where basil binary is located

---
<!-- BELOW THIS LINE: AI-FOCUSED IMPLEMENTATION DETAILS -->

## Technical Context

### Affected Components
- `cmd/basil/main.go` â€” Add `--init` flag parsing and command handler
- `cmd/basil/init.go` (new) â€” Implementation of init command logic

### File Structure Created
```
<foldername>/
â”œâ”€â”€ basil.yaml
â”œâ”€â”€ site/
â”‚   â””â”€â”€ index.pars
â””â”€â”€ public/
```

### basil.yaml Template
```yaml
# Basil Configuration
# Generated by: basil --init

server:
  host: localhost
  port: 8080

# Site mode - filesystem-based routing
# Files in site/ are served at their path (e.g., site/index.pars â†’ /)
site: ./site

# Public directory for static files (CSS, JS, images)
public_dir: ./public

logging:
  level: info
  format: text
  output: stderr
```

### index.pars Content
```parsley
<h1>ðŸŒ¿ Hello from Basil ðŸ‘‹</h1>
```

### Success Message
```
Created new Basil project in '<foldername>'

  <foldername>/
  â”œâ”€â”€ basil.yaml      Configuration
  â”œâ”€â”€ site/           Handlers (filesystem routing)
  â”‚   â””â”€â”€ index.pars  Homepage
  â””â”€â”€ public/         Static files (CSS, JS, images)

Get started:
  cd <foldername>
  basil

Your site will be running at http://localhost:8080
```

### Edge Cases & Constraints

1. **Folder name validation**: Must be valid filesystem path (no NUL bytes, no path traversal)
2. **Non-empty folder**: Error with clear message: "Folder '<name>' is not empty. Use an empty folder or choose a different name."
3. **File exists**: Error if path exists but is a file: "Path '<name>' exists but is a file, not a folder."
4. **Permission errors**: Standard filesystem errors (can't create folder, can't write files)
5. **Relative vs absolute paths**: Support both relative (`./myproject`) and absolute (`/Users/sam/myproject`)

### CLI Integration

Add to help text:
```
  --init <folder>     Create a new Basil project in the specified folder
```

Example usage:
```bash
basil --init myproject
basil --init ./sites/blog
basil --init /Users/sam/projects/website
```

## Implementation Notes
*To be added during implementation*

## Related
- Plan: `docs/plans/FEAT-065-plan.md` (to be created)
- Similar: Rails `rails new`, Hugo `hugo new site`, etc.
