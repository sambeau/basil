// Test markdown AST parsing and rendering

// Basic parsing test
let {markdown} = import @std/markdown

let source = `# Hello World

This is a **paragraph** with *emphasis*.

- Item 1
- Item 2

` + "```javascript\nconsole.log('hello')\n```\n"

let doc = markdown.parse(source)

// Verify structure
print("Document type:", doc.type)
print("Number of children:", doc.children.length())

// Find headings
let headings = doc.children.filter(fn(n) { n.type == "heading" })
print("\nHeadings found:", headings.length())
for h in headings {
    print("  Level", h.level, "-", h.text, "(id:", h.id, ")")
}

// Find code blocks
let codeBlocks = doc.children.filter(fn(n) { n.type == "fenced_code_block" })
print("\nCode blocks found:", codeBlocks.length())
for cb in codeBlocks {
    let lang = cb.language
    if (lang == null) { lang = "none" }
    print("  Language:", lang)
    print("  Code:", cb.code)
}

// Render back to markdown
print("\n--- Rendered Markdown ---")
let rendered = markdown.toMarkdown(doc)
print(rendered)

// Render to HTML
print("\n--- Rendered HTML ---")
let html = markdown.toHTML(doc)
print(html)
